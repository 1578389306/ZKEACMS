angular.module("fieldSetting",[]).controller("setting",["$scope","$filter",function(e,a){e.templates=[{Name:"Label",DisplayName:"标题",Description:"",Placeholder:"",IsRequired:!1,RequiredMessage:"这是必填项",Size:4,Column:"col-md-12",RegexPattern:"",RegexMessage:""},{Name:"SingleLine",DisplayName:"单行输入",Description:"",Placeholder:"",IsRequired:!1,RequiredMessage:"这是必填项",Size:4,Column:"col-md-12",RegexPattern:"",RegexMessage:""},{Name:"Number",DisplayName:"数字",Description:"",Placeholder:"",IsRequired:!1,RequiredMessage:"这是必填项",Size:4,Column:"col-md-12",RegexPattern:"",RegexMessage:""},{Name:"Email",DisplayName:"邮箱地址",Description:"",Placeholder:"",IsRequired:!1,RequiredMessage:"这是必填项",Size:4,Column:"col-md-12",RegexPattern:"",RegexMessage:""},{Name:"Phone",DisplayName:"电话",Description:"",Placeholder:"",IsRequired:!1,RequiredMessage:"这是必填项",Size:4,Column:"col-md-12",RegexPattern:"",RegexMessage:""},{Name:"Paragraph",DisplayName:"多行输入",Description:"",Placeholder:"",IsRequired:!1,RequiredMessage:"这是必填项",Size:4,Column:"col-md-12",RegexPattern:"",RegexMessage:""},{Name:"Date",DisplayName:"日期",Description:"",IsRequired:!1,RequiredMessage:"这是必填项",Size:4,Column:"col-md-12",RegexPattern:"",RegexMessage:""},{Name:"Radio",DisplayName:"单项选择",Description:"",IsRequired:!1,RequiredMessage:"这是必填项",Size:4,Column:"col-md-12",FieldOptions:[{DisplayText:"选项1"},{DisplayText:"选项2"}],RegexPattern:"",RegexMessage:""},{Name:"Dropdown",DisplayName:"下拉选项",Description:"",IsRequired:!1,RequiredMessage:"这是必填项",Size:4,Column:"col-md-12",FieldOptions:[{DisplayText:"选项1"},{DisplayText:"选项2"}],RegexPattern:"",RegexMessage:""},{Name:"Checkbox",DisplayName:"多项选择",Description:"",IsRequired:!1,RequiredMessage:"这是必填项",Size:4,Column:"col-md-12",FieldOptions:[{DisplayText:"选项1"},{DisplayText:"选项2"}],RegexPattern:"",RegexMessage:""},{Name:"Address",DisplayName:"省份地址",Description:"",IsRequired:!1,RequiredMessage:"这是必填项",Size:4,Column:"col-md-12",RegexPattern:"",RegexMessage:""},{Name:"ValidCode",DisplayName:"验证码",Description:"",Placeholder:"",IsRequired:!0,RequiredMessage:"这是必填项",Size:4,Column:"col-md-12",RegexPattern:"",RegexMessage:""}],null!=e.Fields&&0!=e.Fields.length||(e.Fields=[angular.copy(e.templates[0])]),e.fieldInfo=e.Fields[0],e.editTemplate=function(a){e.fieldInfo=a},e.setFieldWidth=function(e,a){e.Style={width:a}},e.setDefaultOption=function(e,a){for(var t=0;t<e.FieldOptions.length;t++)e.FieldOptions[t].DefaultSelected=!1;a.DefaultSelected=!0,e.DefaultSelect=a},e.removeField=function(a){e.Fields=e.Fields.filter(function(e){return e!=a})},e.removeOption=function(e,a){for(var t=0,i=0;i<e.length;i++)e[i]==a&&(t=i);e.splice(t,1)},e.addOption=function(e){e.push({DisplayText:"",Value:"",DefaultSelected:!1})};var t=a("orderBy");e.sortOptions=function(e,a){e=t(e,"DisplayText",a);for(var i=0;i<e.length;i++)e[i].Order=i+1},e.showOptionValue=function(e,a){e.ShowValue=a;for(var t=0;t<e.FieldOptions.length;t++)e.FieldOptions[t].Value||(e.FieldOptions[t].Value=e.FieldOptions[t].DisplayText)},e.dragOver=function(a){for(var t=0,i=0;i<a.currentTarget.parentNode.children.length;i++)if(a.currentTarget===a.currentTarget.parentNode.children[i]){t=i;break}e.Fields[t].onDrop=!0,e.$apply(),a.preventDefault()},e.dragLeave=function(a){for(var t=0,i=0;i<a.currentTarget.parentNode.children.length;i++)if(a.currentTarget===a.currentTarget.parentNode.children[i]){t=i;break}e.Fields[t].onDrop=!1,e.$apply(),a.preventDefault()},e.drag=function(e){for(var a=0,t=0;t<e.currentTarget.parentNode.children.length;t++)if(e.currentTarget===e.currentTarget.parentNode.children[t]){a=t;break}e.dataTransfer.setData("Text",e.target.id+";"+a)},e.drop=function(a){a.preventDefault();for(var t=a.dataTransfer.getData("Text").split(";"),i=0,r=0;r<a.currentTarget.parentNode.children.length;r++)if(a.currentTarget===a.currentTarget.parentNode.children[r]){i=r;break}if(e.Fields[i].onDrop=!1,t[0]){var s=t[0];for(r=0;r<e.templates.length;r++)s==e.templates[r].Name&&e.Fields.splice(i+1,0,angular.copy(e.templates[r]))}else{var l=parseInt(t[1]);e.Fields.splice(i,0,e.Fields.splice(l,1)[0])}e.$apply()},e.columnCute=function(e,a){return e.Column||"col-md-12"},e.save=function(){e.Message=null,$.trim(e.Title)?(Easy.Block(),$.ajax({type:"POST",dataType:"json",url:e.saveUrl,data:JSON.stringify({ID:e.ID,Title:e.Title,Description:e.Description,Description:e.Description,Status:e.Status,CreateBy:e.CreateBy,CreatebyName:e.CreatebyName,CreateDate:e.CreateDate,LastUpdateBy:e.LastUpdateBy,LastUpdateByName:e.LastUpdateByName,LastUpdateDate:e.LastUpdateDate,NotificationReceiver:e.NotificationReceiver,FormFields:e.Fields}),contentType:"application/json; charset=utf-8",async:!0,success:function(a){a.message?(e.Message=a.message,e.$apply()):window.location.href="/Admin/Form"}})):e.Message="请输入表单的名称"}}]);